问题：

```
1、为什么使用消息队列？解耦、异步、削峰
2、使用消息队列有什么缺点?
3、消息队列如何选型?
4、如何保证消息队列是高可用的？
5、如何保证消息不被重复消费?
6、如何保证消费的可靠性传输?
7、如何保证消息的顺序性？
```

ActiveMQ、RabbitMQ、RocketMQ、Kafka

1、目的：

解耦、异步、削峰

2、对比

| 特性       | ActiveMQ                                         | RabbitMQ                                                     | RocketMQ                                                     | kafka                                                        |
| ---------- | ------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 开发语言   | java                                             | erlang                                                       | java                                                         | scala/java                                                   |
| 单机吞吐量 | 万级（比RabbitMQ低）                             | 2.6w/s（消息做持久化）                                       | 10万级                                                       | 10万级                                                       |
| 时效性     | ms级                                             | us级                                                         | ms级                                                         | ms级以内                                                     |
| 订阅形式   | 点对点(p2p)                                      | 广播（发布-订阅）                                            | 提供了4种：direct, topic ,Headers和fanout。fanout就是广播模式 | 基于topic/messageTag以及按照消息类型、属性进行正则匹配的发布订阅模式 |
| 持久化     | 支持少量堆积                                     | 支持少量堆积                                                 | 支持大量堆积                                                 | 支持大量堆积                                                 |
| 顺序消息   | 不支持                                           | 不支持                                                       | 支持                                                         | 支持                                                         |
| 可用性     | 高(主从架构)                                     | 高(主从架构)                                                 | 非常高(分布式架构)                                           | 非常高(分布式架构)                                           |
| 功能特性   | 成熟的产品，应用广；较多的文档；各种协议支持较好 | 基于erlang开发，并发能力很强，性能极其好，延时很低；管理界面较丰富 | MQ功能比较完备，扩展性佳                                     | 只支持主要的MQ功能，像一些消息查询，消息回溯等功能没有提供，在大数据领域应用广。 |



一个是社区活跃度，是否满足需求及业务场景考虑，对并发性，稳定性

小公司用RabbitMq

大公司RocketMQ，kafka

实时计算、日志采集等场景，用 Kafka 

