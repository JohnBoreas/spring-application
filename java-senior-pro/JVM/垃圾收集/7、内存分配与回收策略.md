Java技术体系的自动内存管理，最根本的目标是自动化地解决两个问题：

自动给对象分配内存以及自动回收分配给对象的内存



（1）对象优先在Eden分配

对象在新生代Eden区中分配。当Eden区没有足够空间进行分配时，虚拟机将发起一次Minor GC。 



（2）大对象直接进入老年代

即大量连续内存空间的Java对象，byte[]对象

**目的**：就是避免在Eden区及两个Survivor区之间来回复制，产生大量的内存复制操作

-XX：PretenureSizeThreshold设置进入老年代大小（只在Serial和ParNew有效）



（3）长期存活的对象将进入老年代

​		对象在Survivor区中每熬过一次Minor GC，年龄就增加1岁，当它的年龄增加到一定程 度（默认为15），就会被晋升到老年代中。

对象晋升老年代的年龄阈值，可以通过参数-XX：MaxTenuringThreshold设置。



（4）动态对象年龄判定 

在Survivor空间中相同年龄所有对象大小的总和大于 Survivor空间的一半，年龄大于或等于该年龄的对象就可以直接进入老年代，无须等到-XX：MaxTenuringThreshold中要求的年龄。 



（5）空间分配担保 

发生Minor GC之前，虚拟机必须先检查：老年代最大可用的连续空间是否大于新生代所有对象总空间

​		如果这个条件成立，那这一次Minor GC可以确保是安全的。

​		如果不成立，则虚拟机会先查看-XX：HandlePromotionFailure参数的设置值是否允许担保失败

允许担保：

继续检查老年代最大可用的连续空间是否大于历次晋升到老年代对象的平均大小，

​		如果大于，将尝试进行一次Minor GC，尽管这次Minor GC是有风险的；

​		如果小于，或者-XX：HandlePromotionFailure设置不允许冒险，那这时就要改为进行一次Full GC。 