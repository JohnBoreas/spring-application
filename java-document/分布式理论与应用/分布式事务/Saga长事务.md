		Saga事务模型又叫做长时间运行的事务,由一系列的本地事务构成。每一个本地事务在更新完数据库之

后，会发布一条消息或者一个事件来触发Saga中的下一个本地事务的执行。如果一个本地事务因为某些

业务规则无法满足而失败，Saga会执行在这个失败的事务之前成功提交的所有事务的补偿操作。



Saga的实现有很多种方式，其中最流行的两种方式是：



​		基于事件的方式。这种方式**没有协调中心**，第一个服务执行完本地事务之后，会产生一个事件。其

它服务会监听这个事件，触发该服务本地事务的执行，并产生新的事件。



​		基于命令的方式。我们会定义一个新的服务，这个服务扮演的角色就和一支交响乐乐队的指挥一

样，告诉各个业务参与方，在什么时候做什么事情。我们管这个新服务叫做**协调中心**。协调中心通

过命令/回复的方式来和Saga中其它服务进行交互。

<img src="..\..\resource\Sega命令模式.png" style="zoom:77%;" />



**基于事件方式的优缺点**

优点：简单且容易理解。各参与方相互之间无直接沟通，完全解耦。

缺点：这种方式如果涉及比较多的业务参与方，则比较容易失控。随意监听，产生环形监听



**基于命令方式的优缺点**

优点：

1、 避免了业务方之间的环形依赖（通过协调中心处理，不会直接面对面）。

2、 将分布式事务的管理交由协调中心管理，协调中心对整个逻辑非常清楚。

3、 减少了业务参与方的复杂度。这些业务参与方不再需要监听不同的消息，只是需要响应命令并回复消息。

4、 测试更容易（分布式事务逻辑存在于协调中心，而不是分散在各业务方）。

5、 回滚也更容易。

缺点：

1、 一个可能的缺点就是需要维护协调中心，而这个协调中心并不属于任何业务方。

2、 Saga模式很难调试，特别是涉及许多微服务时。此外，如果系统变得复杂，事件消息可能变得难

以维护。Saga模式的另一个缺点是它没有读取隔离。例如，客户可以看到正在创建的订单，但在

下一秒，订单将因补偿交易而被删除。