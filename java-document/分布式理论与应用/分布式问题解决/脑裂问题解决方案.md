脑裂问题：

脑裂是指在主备切换时，由于切换不彻底或其他原因，导致客户端和Slave误以为出现两个active master，最终使得整个集群处于混乱状态。

通常是发生在节点之间通信不可达(分区)的情况下





Nacos与Zookeeper是如何避免脑裂的? 

leader选举，要求节点的投票数量>总节点数量/2，有这个选举原则保证了集群出现分区，无论如何最多只有一个小集群能选出leader 



M-S模式的集群节点个数为什么一般推荐是奇数个？(偶数个也行，但是很多问题) 

1、偶数个节点的集群一旦节点数对半分区(比如4个节点分区成两个节点和两个节点的情况)，整个集群无法选出 

leader，集群无法提供服务 

2、容错能力相同的情况下奇数节点比偶尔更节约资源，比如5个节点挂两个还能选leader，6个节点最多也只能挂 

两个节点才能保证其能选leader 



Nacos(CP)：类似Raft协议Zookeeper: ZAB协议 

Raft和ZAB都是分布式—致性协议Paxos的简化，两者很类似，主要包括两部分: 

1、leader选举(半数以上节点投票同意) 

2、集群写入数据同步(两阶段提交) 



zooKeeper默认采用了Quorums这种方式来防止"脑裂"现象